Домашнее задание №4

Срок выполнения - 28 октября 2017 (РК1)

Тема: http

----

test_coverage

Это комбинирование задание по тому, как отправлять запросы, получать ответы, работать с параметрами, хедерами, а так же писать тесты.

Задание не сложное, основной объёма работы - написание разных условий и тестов чтобы эти условия удовлетворить.

У нас есть какой-то поисковый сервис (да, опять поиск :) ):
* SearchClient - структура с методом FindUsers, который отправляет запрос во внешнюю систему и возвращает результат, немного преобразуя его
* SearchServer - типа внешняя система. Непосредственно занимается поиском данных в файле `dataset.xml`. В продакшене бы запускалась в виде отдельного веб-сервиса.

Требуется:
1. Написать метод SearchServer в файле `server.go` который вы будете запускать в через тестовый сервер (`httptest.NewServer`, пример использования в `4/2_http/71_server_test.go`)
2. Покрыть тестами метод FindUsers и функцию SearchServer чтобы было покрытие было максимально возможным, в идеал - 100%. Тесты писать в `client_test.go`. Если что-то покрыть не получается - обосновать почему. Так же требуется сгенерировать html-отчет с покрытием. См. пример построения тестового покрытия и отчета в `3/5_testing/*` (напоминаю, для этого ваш код должен находиться внутри GOPATH).
3. Найти и починить баги в FindUsers и написать их в `bugs.txt` :)

Дополнительно:
* Данные для работы лежаит в файле `dataset.xml`
* Параметр `query` ищет по полям `Name` и `About`
* Параметр `order_field` работает по полям `Id`, `Age`, `Name`, если пустой - то возврщаем по `Name`, если что-то другое - ругается ошибкой.
* Если `query` пустой, то делаем только сортироку, т.е. возвращаем все записи
* Напрямую функцию SearchServer вызывать запрещается, только через клиента
* Код можно править во всех файлах (client.go, search.go, client_test.go), но запрещается удалять неугодные вам куски.
* Как работать с XML смотрите в `3/6_xml/*`
* Запускать как `go test -v`

Советы:
* Документация https://golang.org/pkg/net/http/ может помочь
* Не запихивайте всё в 1 тест, напишите много мелких
* Вы можете не ограничиваться функцией SearchServer при тестировании если вам надо проверить какой-то совсем отдельный хитрый кейс. Но таких случаев будет немного. В основном всё будет в SearchServer
* Для получения некоторых ощибочных случаев будет полезно залезть в документацию и посмотрет ькогда же такая ошибка случается
* Производительность, горутины и прочий асинхрон в этом задании не нужны